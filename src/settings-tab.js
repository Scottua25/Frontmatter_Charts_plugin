import { PluginSettingTab, Setting } from "obsidian";
export class HeatmapSettingTab extends PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this._newHeatmapTypeName = "";
        this.plugin = plugin;
    }
    display() {
        const { containerEl } = this;
        containerEl.empty();
        containerEl.createEl("h2", { text: "Heatmap Chart Settings" });
        // Max RDA slider
        new Setting(containerEl)
            .setName("Max RDA% in Heatmap")
            .setDesc("Clamp the color scale to this maximum value")
            .addSlider((slider) => slider
            .setLimits(50, 200, 10)
            .setValue(this.plugin.settings.maxRDA)
            .setDynamicTooltip()
            .onChange(async (value) => {
            this.plugin.settings.maxRDA = value;
            await this.plugin.saveSettings();
        }));
        // Date limit
        new Setting(containerEl)
            .setName("Limit to most recent days")
            .setDesc("0 = no limit")
            .addText((text) => text
            .setPlaceholder("e.g., 7")
            .setValue(this.plugin.settings.limitDays.toString())
            .onChange(async (value) => {
            this.plugin.settings.limitDays = parseInt(value) || 0;
            await this.plugin.saveSettings();
        }));
        // Dynamic heatmap editors
        containerEl.createEl("h3", { text: "Heatmap Types" });
        Object.entries(this.plugin.settings.heatmapTypes).forEach(([key, config]) => {
            const block = containerEl.createDiv({ cls: "heatmap-config-block" });
            // Title + delete button
            new Setting(block)
                .setName(`Type: ${key}`)
                .addButton((btn) => btn.setButtonText("Delete")
                .setWarning()
                .onClick(async () => {
                delete this.plugin.settings.heatmapTypes[key];
                await this.plugin.saveSettings();
                this.display();
            }));
            // Field list
            new Setting(block)
                .setName("Fields (comma-separated)")
                .addText((text) => text
                .setPlaceholder("e.g., protein_g, fat_g")
                .setValue(config.fields.join(", "))
                .onChange(async (value) => {
                this.plugin.settings.heatmapTypes[key].fields = value.split(",").map(s => s.trim());
                await this.plugin.saveSettings();
            }));
            // RDA override (optional)
            new Setting(block)
                .setName("RDA Overrides (field=number, comma-separated)")
                .setDesc("e.g., protein_g=200, fat_g=70")
                .addText((text) => text
                .setPlaceholder("Optional")
                .setValue(config.rda ? Object.entries(config.rda).map(([k, v]) => `${k}=${v}`).join(", ") : "")
                .onChange(async (value) => {
                const rda = {};
                value.split(",").forEach(pair => {
                    const [k, v] = pair.split("=").map(s => s.trim());
                    if (k && v && !isNaN(Number(v)))
                        rda[k] = Number(v);
                });
                this.plugin.settings.heatmapTypes[key].rda = rda;
                await this.plugin.saveSettings();
            }));
        });
        // Add new heatmap type
        new Setting(containerEl)
            .setName("Add New Heatmap Type")
            .setDesc("Enter a unique code block name (e.g., my-nutrients)")
            .addText((text) => text.setPlaceholder("new-heatmap-type").onChange(value => (this._newHeatmapTypeName = value.trim())))
            .addButton((btn) => btn.setButtonText("Add").onClick(async () => {
            const name = this._newHeatmapTypeName;
            if (!name || this.plugin.settings.heatmapTypes[name])
                return;
            this.plugin.settings.heatmapTypes[name] = { fields: [] };
            await this.plugin.saveSettings();
            this.display();
        }));
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0dGluZ3MtdGFiLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic2V0dGluZ3MtdGFiLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTixnQkFBZ0IsRUFDaEIsT0FBTyxFQUdQLE1BQU0sVUFBVSxDQUFDO0FBR2xCLE1BQU0sT0FBTyxpQkFBa0IsU0FBUSxnQkFBZ0I7SUFHdEQsWUFBWSxHQUFRLEVBQUUsTUFBOEI7UUFDbkQsS0FBSyxDQUFDLEdBQUcsRUFBRSxNQUFNLENBQUMsQ0FBQztRQTZHWix3QkFBbUIsR0FBVyxFQUFFLENBQUM7UUE1R3hDLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0lBQ3RCLENBQUM7SUFFRCxPQUFPO1FBQ04sTUFBTSxFQUFFLFdBQVcsRUFBRSxHQUFHLElBQUksQ0FBQztRQUM3QixXQUFXLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDcEIsV0FBVyxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsd0JBQXdCLEVBQUUsQ0FBQyxDQUFDO1FBRS9ELGlCQUFpQjtRQUNqQixJQUFJLE9BQU8sQ0FBQyxXQUFXLENBQUM7YUFDdEIsT0FBTyxDQUFDLHFCQUFxQixDQUFDO2FBQzlCLE9BQU8sQ0FBQyw2Q0FBNkMsQ0FBQzthQUN0RCxTQUFTLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUNyQixNQUFNO2FBQ0osU0FBUyxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDO2FBQ3RCLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUM7YUFDckMsaUJBQWlCLEVBQUU7YUFDbkIsUUFBUSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRTtZQUN6QixJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsS0FBSyxDQUFDO1lBQ3BDLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FB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REFBcUQsQ0FBQzthQUM5RCxPQUFPLENBQUMsQ0FBQyxJQUFtQixFQUFFLEVBQUUsQ0FDaEMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLG1CQUFtQixHQUFHLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQ3BHO2FBQ0EsU0FBUyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FDbEIsR0FBRyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxJQUFJLEVBQUU7WUFDM0MsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDLG1CQUFtQixDQUFDO1lBQ3RDLElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQztnQkFBRSxPQUFPO1lBRTdELElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUUsQ0FBQztZQUN6RCxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsWUFBWSxFQUFFLENBQUM7WUFDakMsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2hCLENBQUMsQ0FBQyxDQUNGLENBQUM7SUFDSixDQUFDO0NBR0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG5cdEFwcCxcclxuXHRQbHVnaW5TZXR0aW5nVGFiLFxyXG5cdFNldHRpbmcsXHJcblx0VGV4dENvbXBvbmVudCxcclxuXHRCdXR0b25Db21wb25lbnRcclxufSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHR5cGUgSGVhdG1hcERhc2hib2FyZFBsdWdpbiBmcm9tIFwiLi4vbWFpblwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEhlYXRtYXBTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcblx0cGx1Z2luOiBIZWF0bWFwRGFzaGJvYXJkUGx1Z2luO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBIZWF0bWFwRGFzaGJvYXJkUGx1Z2luKSB7XHJcblx0XHRzdXBlcihhcHAsIHBsdWdpbik7XHJcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuXHR9XHJcblxyXG5cdGRpc3BsYXkoKTogdm9pZCB7XHJcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHRcdGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIkhlYXRtYXAgQ2hhcnQgU2V0dGluZ3NcIiB9KTtcclxuXHJcblx0XHQvLyBNYXggUkRBIHNsaWRlclxyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKFwiTWF4IFJEQSUgaW4gSGVhdG1hcFwiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIkNsYW1wIHRoZSBjb2xvciBzY2FsZSB0byB0aGlzIG1heGltdW0gdmFsdWVcIilcclxuXHRcdFx0LmFkZFNsaWRlcigoc2xpZGVyKSA9PlxyXG5cdFx0XHRcdHNsaWRlclxyXG5cdFx0XHRcdFx0LnNldExpbWl0cyg1MCwgMjAwLCAxMClcclxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhSREEpXHJcblx0XHRcdFx0XHQuc2V0RHluYW1pY1Rvb2x0aXAoKVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhSREEgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdC8vIERhdGUgbGltaXRcclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZShcIkxpbWl0IHRvIG1vc3QgcmVjZW50IGRheXNcIilcclxuXHRcdFx0LnNldERlc2MoXCIwID0gbm8gbGltaXRcIilcclxuXHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiZS5nLiwgN1wiKVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmxpbWl0RGF5cy50b1N0cmluZygpKVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5saW1pdERheXMgPSBwYXJzZUludCh2YWx1ZSkgfHwgMDtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdC8vIER5bmFtaWMgaGVhdG1hcCBlZGl0b3JzXHJcblx0XHRjb250YWluZXJFbC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogXCJIZWF0bWFwIFR5cGVzXCIgfSk7XHJcblxyXG5cdFx0T2JqZWN0LmVudHJpZXModGhpcy5wbHVnaW4uc2V0dGluZ3MuaGVhdG1hcFR5cGVzKS5mb3JFYWNoKChba2V5LCBjb25maWddKSA9PiB7XHJcblx0XHRcdGNvbnN0IGJsb2NrID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcImhlYXRtYXAtY29uZmlnLWJsb2NrXCIgfSk7XHJcblxyXG5cdFx0XHQvLyBUaXRsZSArIGRlbGV0ZSBidXR0b25cclxuXHRcdFx0bmV3IFNldHRpbmcoYmxvY2spXHJcblx0XHRcdFx0LnNldE5hbWUoYFR5cGU6ICR7a2V5fWApXHJcblx0XHRcdFx0LmFkZEJ1dHRvbigoYnRuOiBCdXR0b25Db21wb25lbnQpID0+XHJcblx0XHRcdFx0XHRidG4uc2V0QnV0dG9uVGV4dChcIkRlbGV0ZVwiKVxyXG5cdFx0XHRcdFx0XHQuc2V0V2FybmluZygpXHJcblx0XHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRkZWxldGUgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGVhdG1hcFR5cGVzW2tleV07XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHJcblx0XHRcdC8vIEZpZWxkIGxpc3RcclxuXHRcdFx0bmV3IFNldHRpbmcoYmxvY2spXHJcblx0XHRcdFx0LnNldE5hbWUoXCJGaWVsZHMgKGNvbW1hLXNlcGFyYXRlZClcIilcclxuXHRcdFx0XHQuYWRkVGV4dCgodGV4dDogVGV4dENvbXBvbmVudCkgPT5cclxuXHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiZS5nLiwgcHJvdGVpbl9nLCBmYXRfZ1wiKVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY29uZmlnLmZpZWxkcy5qb2luKFwiLCBcIikpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5oZWF0bWFwVHlwZXNba2V5XS5maWVsZHMgPSB2YWx1ZS5zcGxpdChcIixcIikubWFwKHMgPT4gcy50cmltKCkpO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHQvLyBSREEgb3ZlcnJpZGUgKG9wdGlvbmFsKVxyXG5cdFx0XHRuZXcgU2V0dGluZyhibG9jaylcclxuXHRcdFx0XHQuc2V0TmFtZShcIlJEQSBPdmVycmlkZXMgKGZpZWxkPW51bWJlciwgY29tbWEtc2VwYXJhdGVkKVwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiZS5nLiwgcHJvdGVpbl9nPTIwMCwgZmF0X2c9NzBcIilcclxuXHRcdFx0XHQuYWRkVGV4dCgodGV4dDogVGV4dENvbXBvbmVudCkgPT5cclxuXHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiT3B0aW9uYWxcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGNvbmZpZy5yZGEgPyBPYmplY3QuZW50cmllcyhjb25maWcucmRhKS5tYXAoKFtrLCB2XSkgPT4gYCR7a309JHt2fWApLmpvaW4oXCIsIFwiKSA6IFwiXCIpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCByZGE6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcclxuXHRcdFx0XHRcdFx0XHR2YWx1ZS5zcGxpdChcIixcIikuZm9yRWFjaChwYWlyID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IFtrLCB2XSA9IHBhaXIuc3BsaXQoXCI9XCIpLm1hcChzID0+IHMudHJpbSgpKTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmIChrICYmIHYgJiYgIWlzTmFOKE51bWJlcih2KSkpIHJkYVtrXSA9IE51bWJlcih2KTtcclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5oZWF0bWFwVHlwZXNba2V5XS5yZGEgPSByZGE7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIEFkZCBuZXcgaGVhdG1hcCB0eXBlXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoXCJBZGQgTmV3IEhlYXRtYXAgVHlwZVwiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIkVudGVyIGEgdW5pcXVlIGNvZGUgYmxvY2sgbmFtZSAoZS5nLiwgbXktbnV0cmllbnRzKVwiKVxyXG5cdFx0XHQuYWRkVGV4dCgodGV4dDogVGV4dENvbXBvbmVudCkgPT5cclxuXHRcdFx0XHR0ZXh0LnNldFBsYWNlaG9sZGVyKFwibmV3LWhlYXRtYXAtdHlwZVwiKS5vbkNoYW5nZSh2YWx1ZSA9PiAodGhpcy5fbmV3SGVhdG1hcFR5cGVOYW1lID0gdmFsdWUudHJpbSgpKSlcclxuXHRcdFx0KVxyXG5cdFx0XHQuYWRkQnV0dG9uKChidG4pID0+XHJcblx0XHRcdFx0YnRuLnNldEJ1dHRvblRleHQoXCJBZGRcIikub25DbGljayhhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRjb25zdCBuYW1lID0gdGhpcy5fbmV3SGVhdG1hcFR5cGVOYW1lO1xyXG5cdFx0XHRcdFx0aWYgKCFuYW1lIHx8IHRoaXMucGx1Z2luLnNldHRpbmdzLmhlYXRtYXBUeXBlc1tuYW1lXSkgcmV0dXJuO1xyXG5cclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmhlYXRtYXBUeXBlc1tuYW1lXSA9IHsgZmllbGRzOiBbXSB9O1xyXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHQpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBfbmV3SGVhdG1hcFR5cGVOYW1lOiBzdHJpbmcgPSBcIlwiO1xyXG59XHJcbiJdfQ==